# -*- coding: utf-8 -*-
"""
Created on Thu Jun 20 14:30:44 2019

@author: Maël Akouz
"""

import xlwt
from Database import*

#Import of the needed documents under a usable format :
txt = PrintText(input('The path of the OAG document : ')) #C:/Users/Maël Akouz/Desktop/OACI/CAEM/Bases_de_Donnees/OAG2018.json
Data = HashTab.database(txt)
print('Size of the Database : ' + str(Data.size()))
#Get the ISO codes of the member states.
txt = PrintText(input('The path of the document containing the Country Codes : ')) #C:/Users/Maël Akouz/Desktop/OACI/CAEM/Bases_de_Donnees/Country_Codes.txt
Code = HashTab.countryCode(txt)

#Creation of the differents databases and their recording in an excel document :
spr = xlwt.Workbook()
Airlines = Data.airlines(Code)
Airlines.excel(spr,'Airlines')
print('Number of Airlines : ' + str(Airlines.size()))
Countries = Airlines.nationAL()
print('Number of Countries : ' + str(Countries.size()))
Countries.excel(spr,'Countries')
Flights = Data.flights(Code)
Flights.linePorts(Data)
print('Number of Airports : ' + str(Flights.size()))
Flights.excel(spr,'Airports Figures')
spr.save('OAG2018.xls')