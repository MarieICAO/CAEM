# -*- coding: utf-8 -*-
"""
Created on Thu Jun 20 14:30:44 2019

@author: Maël Akouz
"""

import xlwt
from Database import*

#Import of the needed documents under a usable format :
txt = ExtractText(input('The path of the complete OAG document : ')) #C:/Users/Maël Akouz/Desktop/OACI/CAEM/Bases_de_Donnees/OAG.json
Data = txt.database_Global()
print('Number of Years in the Database : ' + str(Data.size()))
n = 0
for hmap in Data.htab.values() :
    n = n + hmap.size()
print('Size of the Database : ' + str(n))
#Get the ISO codes of the member states.
txt = ExtractText(input('The path of the document containing the Country Codes : ')) #C:/Users/Maël Akouz/Desktop/OACI/CAEM/Bases_de_Donnees/Country_Codes.txt
Code = txt.countryCode()


#Creation of the differents databases and their recording in sevral excel document :
for k in range(3,20) :
    data = Data.database(2000+k)
    spr = xlwt.Workbook()
    Airlines = data.airlines(Code)
    Airlines.excel(spr,'Airlines')
    print('Number of Airlines : ' + str(Airlines.size()))
    Countries = Airlines.nationAL()
    print('Number of Countries : ' + str(Countries.size()))
    Countries.excel(spr,'Countries')
    Flights = data.flights(Code)
    Flights.linePorts(data)
    print('Number of Airports : ' + str(Flights.size()))
    Flights.excel(spr,'Airports Figures')
    spr.save('OAG' + str(2000+k) + '.xls')